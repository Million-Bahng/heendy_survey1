<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í°ë””ì—ê²Œ ì“°ëŠ” í¸ì§€</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea, #764ba2, #f093fb);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        body::before {
            content: '';
            position: fixed;
            bottom: 20px;
            left: 20px;
            width: min(300px, 30vw);
            height: min(300px, 30vh);
            background: url('./images/heendy-background.png') center/contain no-repeat;
            opacity: 0.25;
            z-index: 0;
            pointer-events: none;
        }

        @media (max-width: 480px) {
            body::before {
                bottom: 15px;
                left: 15px;
                width: min(250px, 25vw);
                height: min(250px, 25vh);
                opacity: 0.2;
            }
        }



        .page {
            display: none;
            min-height: 100vh;
            position: relative;
            padding: 20px;
            justify-content: center;
            align-items: center;
            z-index: 1;
        }

        .page.active {
            display: flex;
        }

        .landing-page {
            background: url('./images/landing-background.jpg') center/cover no-repeat;
            background-size: cover;
            background-position: center;
            padding: 0;
        }

        .landing-content {
            position: absolute;
            bottom: 40px;
            left: 20px;
            right: 20px;
            text-align: center;
        }

        .progress-bar {
            width: 100%;
            height: 6px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 3px;
            overflow: hidden;
            margin-bottom: 10px;
        }

        .progress-fill {
            height: 100%;
            background: white;
            border-radius: 3px;
            width: 0%;
            transition: width 3s linear;
        }

        .progress-text {
            color: white;
            font-size: 14px;
            opacity: 0.9;
        }

        .card {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 24px;
            padding: 32px;
            width: 100%;
            max-width: 400px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            animation: fadeInUp 0.6s ease-out;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .title {
            color: white;
            font-size: 28px;
            font-weight: bold;
            text-align: center;
            margin-bottom: 16px;
            line-height: 1.3;
        }

        .subtitle {
            color: rgba(255, 255, 255, 0.9);
            font-size: 16px;
            text-align: center;
            margin-bottom: 24px;
            line-height: 1.4;
        }

        .input-group {
            margin-bottom: 16px;
        }

        .input-group label {
            display: block;
            color: white;
            font-size: 14px;
            margin-bottom: 8px;
            font-weight: 500;
        }

        .input-group input, .input-group textarea {
            width: 100%;
            padding: 12px 16px;
            border: none;
            border-radius: 12px;
            background: rgba(255, 255, 255, 0.9);
            font-size: 16px;
            outline: none;
            transition: all 0.3s ease;
        }

        .input-group input:focus, .input-group textarea:focus {
            background: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .input-group textarea {
            min-height: 100px;
            resize: vertical;
        }

        .btn {
            width: 100%;
            padding: 16px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.2);
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .btn-primary {
            background: linear-gradient(45deg, #4facfe, #00f2fe);
            color: white;
            margin-bottom: 12px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 4px 15px rgba(79, 172, 254, 0.3);
        }

        .btn-primary:hover {
            box-shadow: 0 8px 25px rgba(79, 172, 254, 0.4);
            transform: translateY(-3px);
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.95);
            color: #333;
            border: 2px solid rgba(255, 255, 255, 0.5);
            box-shadow: 0 4px 15px rgba(255, 255, 255, 0.2);
        }

        .btn-secondary:hover {
            background: white;
            box-shadow: 0 8px 25px rgba(255, 255, 255, 0.3);
        }

        .notice {
            background: rgba(128, 128, 128, 0.1);
            color: rgba(255, 255, 255, 0.8);
            padding: 12px;
            border-radius: 8px;
            font-size: 12px;
            margin-top: 16px;
            text-align: left;
        }

        .progress-header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            padding: 16px 20px;
            z-index: 100;
        }

        .progress-header-bar {
            width: 100%;
            height: 4px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 2px;
            overflow: hidden;
        }

        .progress-header-fill {
            height: 100%;
            background: white;
            border-radius: 2px;
            transition: width 0.3s ease;
        }

        .question-number {
            color: white;
            font-size: 14px;
            margin-bottom: 8px;
            text-align: center;
        }

        .quiz-options {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-top: 24px;
        }

        .quiz-options.two-options {
            flex-direction: row;
            gap: 8px;
        }

        .quiz-option {
            padding: 16px;
            background: rgba(255, 255, 255, 0.95);
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 12px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: left;
            box-shadow: 0 2px 10px rgba(255, 255, 255, 0.1);
        }

        .quiz-option:hover {
            background: white;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(255, 255, 255, 0.2);
            border-color: #4facfe;
        }

        .quiz-options.two-options .quiz-option {
            flex: 1;
            text-align: center;
            font-size: 14px;
        }

        .quiz-options.four-options .quiz-option {
            padding: 12px;
            font-size: 14px;
        }

        .result-card {
            text-align: center;
        }

        .score-display {
            background: rgba(255, 255, 255, 0.2);
            padding: 20px;
            border-radius: 16px;
            margin: 20px 0;
        }

        .score-number {
            font-size: 48px;
            font-weight: bold;
            color: white;
            margin-bottom: 8px;
        }

        .score-text {
            font-size: 16px;
            color: rgba(255, 255, 255, 0.9);
        }

        .score-message {
            font-size: 20px;
            font-weight: bold;
            color: white;
            margin: 16px 0;
        }

        .event-info {
            background: white;
            color: #333;
            padding: 16px;
            border-radius: 12px;
            border: 2px solid #4a90e2;
            margin: 20px 0;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: linear-gradient(135deg, #ffd700, #ffed4a);
            padding: 32px;
            border-radius: 20px;
            text-align: center;
            max-width: 320px;
            margin: 20px;
            animation: bounceIn 0.6s ease-out;
        }

        .modal-content.lose {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
        }

        @keyframes bounceIn {
            0% {
                transform: scale(0.3);
                opacity: 0;
            }
            50% {
                transform: scale(1.05);
            }
            70% {
                transform: scale(0.9);
            }
            100% {
                transform: scale(1);
                opacity: 1;
            }
        }

        .modal-title {
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 16px;
            color: #333;
        }

        .modal-content.lose .modal-title {
            color: white;
        }

        .modal-text {
            font-size: 16px;
            line-height: 1.4;
            color: #333;
        }

        .modal-content.lose .modal-text {
            color: rgba(255, 255, 255, 0.9);
        }

        .close-modal {
            margin-top: 20px;
            padding: 12px 24px;
            background: #333;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
        }

        .modal-content.lose .close-modal {
            background: rgba(255, 255, 255, 0.2);
            color: white;
        }



        .quiz-option.correct {
            background: linear-gradient(45deg, #4CAF50, #45a049) !important;
            color: white !important;
            border-color: #4CAF50 !important;
            animation: correctPulse 0.6s ease-out;
        }

        .quiz-option.incorrect {
            background: linear-gradient(45deg, #f44336, #d32f2f) !important;
            color: white !important;
            border-color: #f44336 !important;
            animation: incorrectShake 0.6s ease-out;
        }

        .quiz-option.show-correct {
            background: linear-gradient(45deg, #4CAF50, #45a049) !important;
            color: white !important;
            border-color: #4CAF50 !important;
            animation: showCorrectPulse 0.8s ease-out;
        }

        @keyframes correctPulse {
            0% {
                transform: scale(1);
                box-shadow: 0 0 0 0 rgba(76, 175, 80, 0.7);
            }
            50% {
                transform: scale(1.05);
                box-shadow: 0 0 0 10px rgba(76, 175, 80, 0.3);
            }
            100% {
                transform: scale(1);
                box-shadow: 0 0 0 20px rgba(76, 175, 80, 0);
            }
        }

        @keyframes incorrectShake {
            0%, 100% {
                transform: translateX(0);
            }
            10%, 30%, 50%, 70%, 90% {
                transform: translateX(-5px);
            }
            20%, 40%, 60%, 80% {
                transform: translateX(5px);
            }
        }

        @keyframes showCorrectPulse {
            0% {
                transform: scale(1);
                opacity: 0.5;
            }
            50% {
                transform: scale(1.02);
                opacity: 1;
            }
            100% {
                transform: scale(1);
                opacity: 1;
            }
        }

        .feedback-message {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(255, 255, 255, 0.95);
            padding: 20px 30px;
            border-radius: 20px;
            font-size: 20px;
            font-weight: bold;
            color: #333;
            z-index: 1000;
            opacity: 0;
            animation: feedbackShow 1.5s ease-out;
            pointer-events: none;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        .feedback-message.correct {
            background: linear-gradient(45deg, #4CAF50, #45a049);
            color: white;
        }

        .feedback-message.incorrect {
            background: linear-gradient(45deg, #ff9800, #f57c00);
            color: white;
        }

        @keyframes feedbackShow {
            0% {
                opacity: 0;
                transform: translate(-50%, -50%) scale(0.5);
            }
            20% {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1.1);
            }
            40% {
                transform: translate(-50%, -50%) scale(1);
            }
            100% {
                opacity: 0;
                transform: translate(-50%, -50%) scale(1);
            }
        }
            .card {
                padding: 24px;
                margin: 10px;
            }
            
            .title {
                font-size: 24px;
            }
            
            .quiz-options.two-options .quiz-option {
                font-size: 13px;
                padding: 12px 8px;
            }
        }
    </style>
</head>
<body>


    <!-- ìˆ¨ê²¨ì§„ Netlify Form -->
    <form name="heendy-survey" netlify netlify-honeypot="bot-field" hidden>
        <p hidden>
            <label>Don't fill this out: <input name="bot-field" /></label>
        </p>
        <input type="text" name="employeeId" />
        <input type="text" name="name" />
        <textarea name="survey1"></textarea>
        <textarea name="survey2"></textarea>
        <input type="number" name="score" />
        <input type="text" name="quizTaken" />
        <input type="text" name="isWinner" />
        <input type="number" name="responseTime" />
        <input type="text" name="timestamp" />
    </form>
    <div class="progress-header" id="progressHeader" style="display: none;">
        <div class="progress-header-bar">
            <div class="progress-header-fill" id="progressHeaderFill"></div>
        </div>
    </div>

    <!-- ëœë”© í˜ì´ì§€ -->
    <div class="page landing-page active" id="landingPage">
        <div class="landing-content">
            <div class="progress-bar">
                <div class="progress-fill" id="landingProgress"></div>
            </div>
            <div class="progress-text">3ì´ˆ í›„ ì‹œì‘í˜ì´ì§€ë¡œ ì´ë™í•©ë‹ˆë‹¤</div>
        </div>
    </div>

    <!-- ì‹œì‘ í˜ì´ì§€ -->
    <div class="page" id="startPage">
        <div class="card">
            <h1 class="title">í°ë””ì—ê²Œ ì“°ëŠ” í¸ì§€</h1>
            <p class="subtitle">ì„¤ë¬¸ì— ì°¸ì—¬í•˜ì‹  ë¶„ê»˜ <br> ì¶”ì²¨ì„ í†µí•´ í°ë”” ë™ì „ì§€ê°‘ì„ 50ë¶„ê»˜ ë“œë¦½ë‹ˆë‹¤!</p>
            
            <div class="input-group">
                <label for="employeeId">ì‚¬ë²ˆ</label>
                <input type="text" id="employeeId" required>
            </div>
            
            <div class="input-group">
                <label for="name">ì´ë¦„</label>
                <input type="text" id="name" required>
            </div>
            
            <button class="btn btn-primary" id="startBtn" onclick="startSurvey()" disabled>ì‹œì‘í•˜ê¸°</button>
            
            <div class="notice">
                ì…ë ¥í•˜ì‹  ì •ë³´ëŠ” ë‹¹ì²¨ì í™•ì¸ì„ ìœ„í•´ 7/22(í™”)ê¹Œì§€ ì‚¬ìš©ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤
            </div>
        </div>
    </div>

    <!-- ì„¤ë¬¸ í˜ì´ì§€ 1 -->
    <div class="page" id="survey1Page">
        <div class="card">
            <div class="question-number">ì„¤ë¬¸ 1/2</div>
            <h2 class="title">ì œì‘í•˜ë©´ ì¢‹ì„ ê²ƒ ê°™ì€ í°ë”” ìƒí’ˆì— ëŒ€í•œ ì•„ì´ë””ì–´ ë¶€íƒë“œë¦½ë‹ˆë‹¤</h2>
            
            <div class="input-group">
                <textarea id="survey1" placeholder="ì˜ˆì‹œ) ì ¤ë¦¬ìº£ ê°™ì€ ì¸í˜•" required></textarea>
            </div>
            
            <button class="btn btn-primary" id="survey1NextBtn" onclick="nextSurvey1()" disabled>ë‹¤ìŒ</button>
        </div>
    </div>

    <!-- ì„¤ë¬¸ í˜ì´ì§€ 2 -->
    <div class="page" id="survey2Page">
        <div class="card">
            <div class="question-number">ì„¤ë¬¸ 2/2</div>
            <h2 class="title">í°ë””ì—ê²Œ ë°”ë¼ëŠ” ì½˜í…ì¸  ë˜ëŠ” ìŠ¤í† ë¦¬ê°€ ìˆë‹¤ë©´ ì•Œë ¤ì£¼ì„¸ìš”</h2>
            
            <div class="input-group">
                <textarea id="survey2" placeholder="ì˜ˆì‹œ) ë°±í™”ì ì„ ì‡¼í•‘í•˜ëŠ” ìŠ¤í† ë¦¬" required></textarea>
            </div>
            
            <button class="btn btn-primary" id="survey2NextBtn" onclick="nextSurvey2()" disabled>ë‹¤ìŒ</button>
        </div>
    </div>

    <!-- í€´ì¦ˆ ì‹œì‘ í˜ì´ì§€ -->
    <div class="page" id="quizStartPage">
        <div class="card">
            <h1 class="title">í€´ì¦ˆ ë¬¸ì œì— ë„ì „í•˜ì‹œë©´ <br> ë™ì „ì§€ê°‘ ë‹¹ì²¨ í™•ë¥ ì´ ğŸ†™</h1>
            <p class="subtitle">ë¬¸ì œë¥¼ ì„ íƒí•˜ë©´ ë‹¤ìŒ ë¬¸ì œë¡œ ë„˜ì–´ê°‘ë‹ˆë‹¤!</p>
            
            <button class="btn btn-primary" onclick="startQuiz()">ë„ì „í•˜ê¸°</button>
            <button class="btn btn-secondary" onclick="skipQuiz()">ê·¸ë§Œí•˜ê¸°</button>
        </div>
    </div>

    <!-- í€´ì¦ˆ ë¬¸ì œ í˜ì´ì§€ë“¤ -->
    <div class="page" id="quizPage">
        <div class="card">
            <div class="question-number" id="questionNumber">ë¬¸ì œ 1/10</div>
            <h2 class="title" id="questionTitle">ë¬¸ì œë¥¼ ë¡œë”©ì¤‘ì…ë‹ˆë‹¤...</h2>
            <div class="quiz-options" id="quizOptions">
                <!-- ë™ì ìœ¼ë¡œ ìƒì„±ë¨ -->
            </div>
        </div>
    </div>

    <!-- ê²°ê³¼ í˜ì´ì§€ -->
    <div class="page" id="resultPage">
        <div class="card result-card">
            <h1 class="title">ì°¸ì—¬í•´ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤</h1>
            
            <div id="scoreDisplay" class="score-display" style="display: none;">
                <div class="score-number" id="scoreNumber">0</div>
                <div class="score-text" id="scoreText">10ë¬¸ì œ ì¤‘ 0ë¬¸ì œ ì •ë‹µ</div>
                <div class="score-message" id="scoreMessage">ë” ê³µë¶€í•´ì£¼ì„¸ìš”!</div>
            </div>
            
            <div class="event-info">
                7/21(ì›”)~7/22(í™”)ì—<br>ë³¸ì‚¬ ì‚¬ì˜¥ 1ì¸µ ì§ì›í–‰ì‚¬ì—ì„œ ë§Œë‚˜ìš”!
            </div>
        </div>
    </div>

    <!-- ë‹¹ì²¨/ë¹„ë‹¹ì²¨ ëª¨ë‹¬ -->
    <div class="modal" id="resultModal">
        <div class="modal-content" id="modalContent">
            <div class="modal-title" id="modalTitle">ê²°ê³¼</div>
            <div class="modal-text" id="modalText">ê²°ê³¼ë¥¼ í™•ì¸í•˜ëŠ” ì¤‘ì…ë‹ˆë‹¤...</div>
            <button class="close-modal" onclick="closeModal()">í™•ì¸</button>
        </div>
    </div>

    <script>
        // ì „ì—­ ë³€ìˆ˜
        let currentQuestionIndex = 0;
        let score = 0;
        let userAnswers = [];
        let startTime = new Date();
        let userData = {
            employeeId: '',
            name: '',
            survey1: '',
            survey2: '',
            quizTaken: false,
            score: 0,
            isWinner: false
        };

        // í€´ì¦ˆ ë¬¸ì œ ë°ì´í„°
        const quizQuestions = [
            {
                question: "í°ë””ê°€ íƒ„ìƒí•œ ì—°ë„ëŠ”?",
                options: ["2019", "2022", "2023", "2025"],
                correct: 0
            },
            {
                question: "í°ë””ëŠ” ë¬´ìŠ¨ ë™ë¬¼ì„ ëª¨í‹°ë¸Œë¡œ ì‚¼ì•˜ì„ê¹Œìš”?",
                options: ["ê°œ", "ê³ ì–‘ì´", "ê³°"],
                correct: 0
            },
            {
                question: "í°ë””ëŠ” ë¬´ìŠ¨ ì¢…ì¼ê¹Œìš”?",
                options: ["ì§„ë—ê°œ", "ì‚½ì‚´ê°œ", "ì›¨ìŠ¤íŠ¸ í•˜ì´ëœë“œ í™”ì´íŠ¸ í…Œë¦¬ì–´", "ì•„ì´ë¦¬ì‹œ ì†Œí”„íŠ¸ ì½”í‹°ë“œ íœ˜íŠ¼ í…Œë¦¬ì–´"],
                correct: 2
            },
            {
                question: "í°ë””ì˜ ì˜ë¬¸ëª…ì€ ë¬´ì—‡ì¼ê¹Œìš”?",
                options: ["Heendy", "Heundi", "WhiteD"],
                correct: 0
            },
            {
                question: "ë‹¤ìŒì¤‘ í°ë””ë¥¼ ì„¤ëª…í•˜ëŠ” ìˆ˜ì‹ì–´ëŠ” ë¬´ì—‡ì¼ê¹Œìš”?",
                options: ["í˜¸ë½í˜¸ë½í•˜ì§€ ì•Šì€ í–‰ë³µìº", "ìƒìƒë ¥ì´ í’ë¶€í•œ ê³µê°ìº", "ì„¸ìƒì´ ì•Œê³  ì‹¶ì€ í˜¸ê¸°ì‹¬ìº", "ì§€ë£¨í•œ ê±´ ëª» ì°¸ëŠ” í–‰ë™ìº"],
                correct: 0
            },
            {
                question: "ë‹¤ìŒì¤‘ í°ë””ì˜ ì¸ìŠ¤íƒ€ê·¸ë¨ ê³„ì •ì£¼ì†ŒëŠ” ë¬´ì—‡ì¼ê¹Œìš”?",
                options: ["@heendy.life", "@heendy.white", "@heendy.begins"],
                correct: 0
            },
            {
                question: "í°ë””ì˜ ìƒí’ˆì€ ëª‡ê°€ì§€ê°€ ìˆì„ê¹Œìš”?",
                options: ["ìƒí’ˆì€ ì—†ê³  ì‚¬ì€í’ˆë§Œ ìˆë‹¤", "20ê°œ", "120ê°œ"],
                correct: 2
            },
            {
                question: "í°ë””ì˜ ìƒí’ˆì€ í˜„ì¬ ì–´ë””ì„œ ë§Œë‚˜ë³¼ ìˆ˜ ìˆì„ê¹Œìš”?",
                options: ["íŒë§¤í•˜ëŠ” ê³³ì´ ì—†ë‹¤", "ë”í˜„ëŒ€ì„œìš¸ 5ì¸µ ë”í˜„ëŒ€ í”„ë ˆì  íŠ¸", "ê¹€í¬ì  í•‘í¬í•˜ìš°ìŠ¤", "ë”í˜„ëŒ€ì„œìš¸ 5ì¸µ í°ë””ìƒµ"],
                correct: 1
            },
            {
                question: "í°ë””ì™€ ì½œë¼ë³´ë ˆì´ì…˜í•œ ìºë¦­í„°ëŠ” ë¬´ì—‡ì¼ê¹Œìš”?",
                options: ["ë¹µë¹µì´", "ìµœê³ ì‹¬", "ë¯¸í‚¤ë§ˆìš°ìŠ¤"],
                correct: 1
            },
            {
                question: "ì•„ë˜ì—ì„œ ì¡´ì¬í•˜ì§€ ì•ŠëŠ” í°ë”” ìƒí’ˆì€ ë¬´ì—‡ì¼ê¹Œìš”?",
                options: ["í°ë”” í˜ì´ìŠ¤ì¿ ì…˜", "í°ë”” ë§ë‘ë² ê°œ", "í°ë”” ë‚©ì‘ ì¸í˜•", "í°ë”” í­ì‹  í‚¤ë§"],
                correct: 3
            }
        ];

        // Netlify Formsìœ¼ë¡œ ë°ì´í„° ì „ì†¡
        async function submitToNetlify() {
            const formData = new FormData();
            formData.append('form-name', 'heendy-survey');
            formData.append('employeeId', userData.employeeId);
            formData.append('name', userData.name);
            formData.append('survey1', userData.survey1);
            formData.append('survey2', userData.survey2);
            formData.append('score', userData.score);
            formData.append('quizTaken', userData.quizTaken ? 'ì°¸ì—¬' : 'ë¯¸ì°¸ì—¬');
            formData.append('isWinner', userData.isWinner ? 'ë‹¹ì²¨' : 'ë¹„ë‹¹ì²¨');
            formData.append('responseTime', Math.round((new Date() - startTime) / 1000));
            formData.append('timestamp', new Date().toLocaleString('ko-KR'));

            try {
                const response = await fetch('/', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
                    body: new URLSearchParams(formData).toString()
                });
                
                if (response.ok) {
                    console.log('ë°ì´í„°ê°€ ì„±ê³µì ìœ¼ë¡œ ì œì¶œë˜ì—ˆìŠµë‹ˆë‹¤.');
                } else {
                    console.error('ë°ì´í„° ì œì¶œ ì‹¤íŒ¨:', response.status);
                }
            } catch (error) {
                console.error('ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜:', error);
                // ì˜¤ë¥˜ê°€ ë°œìƒí•´ë„ ì‚¬ìš©ì ê²½í—˜ì„ ë°©í•´í•˜ì§€ ì•ŠìŒ
            }
        }

        // í˜ì´ì§€ ì „í™˜ í•¨ìˆ˜
        function showPage(pageId) {
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            document.getElementById(pageId).classList.add('active');
            
            // ì§„í–‰ë¥  í—¤ë” í‘œì‹œ/ìˆ¨ê¹€
            const showProgress = ['survey1Page', 'survey2Page', 'quizPage'].includes(pageId);
            document.getElementById('progressHeader').style.display = showProgress ? 'block' : 'none';
            
            if (showProgress) {
                updateProgressHeader();
            }
        }

        function updateProgressHeader() {
            let progress = 0;
            const currentPage = document.querySelector('.page.active').id;
            
            if (currentPage === 'survey1Page') progress = 10;
            else if (currentPage === 'survey2Page') progress = 20;
            else if (currentPage === 'quizPage') progress = 20 + (currentQuestionIndex + 1) * 8;
            
            document.getElementById('progressHeaderFill').style.width = progress + '%';
        }

        // ëœë”© í˜ì´ì§€ ë¡œì§
        function startLandingTimer() {
            const progressBar = document.getElementById('landingProgress');
            
            // ì¦‰ì‹œ ì• ë‹ˆë©”ì´ì…˜ ì‹œì‘ (0%ì—ì„œ 100%ê¹Œì§€ 3ì´ˆë™ì•ˆ)
            setTimeout(() => {
                progressBar.style.width = '100%';
            }, 100);
            
            setTimeout(() => {
                showPage('startPage');
            }, 3000);
        }

        // ì‹œì‘ í˜ì´ì§€ ë¡œì§
        function validateStartForm() {
            const employeeId = document.getElementById('employeeId').value.trim();
            const name = document.getElementById('name').value.trim();
            const startBtn = document.getElementById('startBtn');
            
            if (employeeId && name) {
                startBtn.disabled = false;
                userData.employeeId = employeeId;
                userData.name = name;
            } else {
                startBtn.disabled = true;
            }
        }

        function startSurvey() {
            showPage('survey1Page');
        }

        // ì„¤ë¬¸ í˜ì´ì§€ ë¡œì§
        function validateSurvey1() {
            const survey1 = document.getElementById('survey1').value.trim();
            const nextBtn = document.getElementById('survey1NextBtn');
            
            if (survey1) {
                nextBtn.disabled = false;
                userData.survey1 = survey1;
            } else {
                nextBtn.disabled = true;
            }
        }

        function validateSurvey2() {
            const survey2 = document.getElementById('survey2').value.trim();
            const nextBtn = document.getElementById('survey2NextBtn');
            
            if (survey2) {
                nextBtn.disabled = false;
                userData.survey2 = survey2;
            } else {
                nextBtn.disabled = true;
            }
        }

        function nextSurvey1() {
            showPage('survey2Page');
        }

        function nextSurvey2() {
            showPage('quizStartPage');
        }

        // í€´ì¦ˆ ë¡œì§
        function startQuiz() {
            userData.quizTaken = true;
            currentQuestionIndex = 0;
            score = 0;
            userAnswers = [];
            showPage('quizPage');
            displayQuestion();
        }

        function skipQuiz() {
            userData.quizTaken = false;
            showResultPage();
        }

        function displayQuestion() {
            const question = quizQuestions[currentQuestionIndex];
            document.getElementById('questionNumber').textContent = `ë¬¸ì œ ${currentQuestionIndex + 1}/10`;
            document.getElementById('questionTitle').textContent = question.question;
            
            const optionsContainer = document.getElementById('quizOptions');
            optionsContainer.innerHTML = '';
            
            // ì˜µì…˜ ê°œìˆ˜ì— ë”°ë¥¸ í´ë˜ìŠ¤ ì„¤ì •
            const optionCount = question.options.length;
            if (optionCount === 2) {
                optionsContainer.className = 'quiz-options two-options';
            } else if (optionCount === 3) {
                optionsContainer.className = 'quiz-options three-options';
            } else {
                optionsContainer.className = 'quiz-options four-options';
            }
            
            question.options.forEach((option, index) => {
                const button = document.createElement('button');
                button.className = 'quiz-option';
                button.textContent = option;
                button.onclick = () => selectAnswer(index);
                optionsContainer.appendChild(button);
            });
            
            updateProgressHeader();
        }

        // í–…í‹± í”¼ë“œë°± í•¨ìˆ˜
        function triggerHapticFeedback(type = 'light') {
            if ('vibrate' in navigator) {
                switch(type) {
                    case 'correct':
                        navigator.vibrate([50, 30, 50]); // ì§§ì€-ì§§ì€-ì§§ì€ (ì„±ê³µ)
                        break;
                    case 'incorrect':
                        navigator.vibrate([100, 50, 100, 50, 100]); // ê¸¸ê³  ë°˜ë³µ (ì‹¤íŒ¨)
                        break;
                    case 'light':
                        navigator.vibrate(50); // ê°€ë²¼ìš´ í„°ì¹˜
                        break;
                }
            }
        }

        // í”¼ë“œë°± ë©”ì‹œì§€ í‘œì‹œ í•¨ìˆ˜
        function showFeedbackMessage(message, type) {
            const feedbackDiv = document.createElement('div');
            feedbackDiv.className = `feedback-message ${type}`;
            feedbackDiv.textContent = message;
            document.body.appendChild(feedbackDiv);
            
            setTimeout(() => {
                document.body.removeChild(feedbackDiv);
            }, 1500);
        }

        function selectAnswer(selectedIndex) {
            const question = quizQuestions[currentQuestionIndex];
            userAnswers.push(selectedIndex);
            
            const options = document.querySelectorAll('.quiz-option');
            const isCorrect = selectedIndex === question.correct;
            
            // ì„ íƒí•œ ë‹µì•ˆì— ì¦‰ì‹œ ìŠ¤íƒ€ì¼ ì ìš©
            if (isCorrect) {
                options[selectedIndex].classList.add('correct');
                score++;
                triggerHapticFeedback('correct');
                showFeedbackMessage('ë§ì•˜ì–´ìš”! ğŸ‰', 'correct');
            } else {
                options[selectedIndex].classList.add('incorrect');
                triggerHapticFeedback('incorrect');
                showFeedbackMessage('ì•„ì‰¬ì›Œìš”! ğŸ˜…', 'incorrect');
                
                // 1ì´ˆ í›„ ì •ë‹µ í‘œì‹œ
                setTimeout(() => {
                    options[question.correct].classList.add('show-correct');
                }, 1000);
            }
            
            // ëª¨ë“  ë²„íŠ¼ ë¹„í™œì„±í™”
            options.forEach(option => {
                option.style.pointerEvents = 'none';
            });
            
            // ì •ë‹µ/ì˜¤ë‹µì— ë”°ë¥¸ ëŒ€ê¸° ì‹œê°„ ì¡°ì •
            const waitTime = isCorrect ? 1500 : 2500;
            
            setTimeout(() => {
                currentQuestionIndex++;
                if (currentQuestionIndex < quizQuestions.length) {
                    displayQuestion();
                } else {
                    finishQuiz();
                }
            }, waitTime);
        }

        function finishQuiz() {
            userData.score = Math.round((score / quizQuestions.length) * 100);
            showResultPage();
        }

        // ë‹¹ì²¨ì ìˆ˜ ì²´í¬ ë° ë‹¹ì²¨ ë¡œì§
        async function checkWinning() {
            try {
                // Netlify Forms APIë¡œ ë‹¹ì²¨ì ìˆ˜ í™•ì¸
                const response = await fetch('/.netlify/functions/check-winners');
                let winnerCount = 50; // ê¸°ë³¸ê°’ìœ¼ë¡œ 50ëª… ì œí•œ
                
                if (response.ok) {
                    const data = await response.json();
                    winnerCount = data.winnerCount || 0;
                }
                
                // 50ëª… ì´ìƒì´ë©´ ë¬´ì¡°ê±´ ë¹„ë‹¹ì²¨
                if (winnerCount >= 50) {
                    userData.isWinner = false;
                    return;
                }
                
                // í™•ë¥  ê³„ì‚° (ë‚¨ì€ ìë¦¬ê°€ ì ì„ìˆ˜ë¡ í™•ë¥  ê°ì†Œ)
                const remainingSlots = 50 - winnerCount;
                const baseProbability = userData.quizTaken ? 0.5 : 0.25;
                
                // ë‚¨ì€ ìë¦¬ê°€ 10ê°œ ì´í•˜ë©´ í™•ë¥  ì¡°ì •
                let adjustedProbability = baseProbability;
                if (remainingSlots <= 10) {
                    adjustedProbability = baseProbability * (remainingSlots / 20);
                }
                
                userData.isWinner = Math.random() < adjustedProbability;
                
            } catch (error) {
                console.error('ë‹¹ì²¨ì ìˆ˜ í™•ì¸ ì¤‘ ì˜¤ë¥˜:', error);
                // ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ì‹œ ê¸°ë³¸ í™•ë¥ ë¡œ ì§„í–‰
                const baseProbability = userData.quizTaken ? 0.3 : 0.15; // ì˜¤ë¥˜ì‹œ í™•ë¥  ë‚®ì¶¤
                userData.isWinner = Math.random() < baseProbability;
            }
        }

        // ê²°ê³¼ í˜ì´ì§€ í‘œì‹œ
        async function showResultPage() {
            showPage('resultPage');
            
            if (userData.quizTaken) {
                document.getElementById('scoreDisplay').style.display = 'block';
                document.getElementById('scoreNumber').textContent = userData.score + 'ì ';
                document.getElementById('scoreText').textContent = `10ë¬¸ì œ ì¤‘ ${score}ë¬¸ì œ ì •ë‹µ`;
                
                let message = 'ë” ê³µë¶€í•´ì£¼ì„¸ìš”!';
                if (userData.score >= 90) message = 'ì™„ë²½í•´ìš”!';
                else if (userData.score >= 70) message = 'í›Œë¥­í•´ìš”!';
                else if (userData.score >= 50) message = 'ê´œì°®ì•„ìš”!';
                
                document.getElementById('scoreMessage').textContent = message;
            }
            
            // ë‹¹ì²¨ ì—¬ë¶€ í™•ì¸ (ë¹„ë™ê¸°)
            await checkWinning();
            
            // Netlify Formsë¡œ ì „ì†¡
            await submitToNetlify();
            
            setTimeout(() => {
                showResultModal();
            }, 1000);
        }

        function showResultModal() {
            const modal = document.getElementById('resultModal');
            const modalContent = document.getElementById('modalContent');
            const modalTitle = document.getElementById('modalTitle');
            const modalText = document.getElementById('modalText');
            
            if (userData.isWinner) {
                modalContent.className = 'modal-content';
                modalTitle.textContent = 'ì¶•í•˜ë“œë¦½ë‹ˆë‹¤ğŸ‰';
                modalText.innerHTML = 'í°ë”” ë™ì „ì§€ê°‘ì— ë‹¹ì²¨ë˜ì…¨ìŠµë‹ˆë‹¤!<br><br>ì§ì›í–‰ì‚¬ì¥(ë³¸ì‚¬ 1ì¸µ, 7/21~22)ì—ì„œ <br>ì‚¬ë²ˆê³¼ í•¨ê»˜ í˜„ì¬ í™”ë©´ì„ ìº¡ì²˜í•´ì„œ ë³´ì—¬ì£¼ì„¸ìš”.';
            } else {
                modalContent.className = 'modal-content lose';
                modalTitle.textContent = 'ì•„ì‰¬ì›Œìš”ğŸ˜­';
                modalText.innerHTML = 'ì•ˆíƒ€ê¹ê²Œ ë‹¹ì²¨ë˜ì§„ ì•Šì•˜ìŠµë‹ˆë‹¤.ğŸ˜­ <br> í•˜ì§€ë§Œ, í°ë””ì— ëŒ€í•œ ê´€ì‹¬ì„ <br> ì§ì›í–‰ì‚¬ì¥(ë³¸ì‚¬ 1ì¸µ, 7/21~22)ì—ì„œ ì´ì–´ê°€ì£¼ì„¸ìš”!';
            }
            
            modal.classList.add('active');
        }

        function closeModal() {
            document.getElementById('resultModal').classList.remove('active');
        }

        // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì •
        document.addEventListener('DOMContentLoaded', function() {
            startLandingTimer();
            
            // ì…ë ¥ í•„ë“œ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
            document.getElementById('employeeId').addEventListener('input', validateStartForm);
            document.getElementById('name').addEventListener('input', validateStartForm);
            document.getElementById('survey1').addEventListener('input', validateSurvey1);
            document.getElementById('survey2').addEventListener('input', validateSurvey2);
            
            // ëª¨ë‹¬ ì™¸ë¶€ í´ë¦­ì‹œ ë‹«ê¸°
            document.getElementById('resultModal').addEventListener('click', function(e) {
                if (e.target === this) {
                    closeModal();
                }
            });
            
            // ë²„íŠ¼ í´ë¦­ì‹œ ê°€ë²¼ìš´ í–…í‹± í”¼ë“œë°±
            document.addEventListener('click', function(e) {
                if (e.target.classList.contains('btn') || e.target.classList.contains('quiz-option')) {
                    triggerHapticFeedback('light');
                }
            });
            document.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    const activePageId = document.querySelector('.page.active').id;
                    
                    if (activePageId === 'startPage' && !document.getElementById('startBtn').disabled) {
                        startSurvey();
                    } else if (activePageId === 'survey1Page' && !document.getElementById('survey1NextBtn').disabled) {
                        nextSurvey1();
                    } else if (activePageId === 'survey2Page' && !document.getElementById('survey2NextBtn').disabled) {
                        nextSurvey2();
                    }
                }
            });
        });


    </script>
</body>
</html>
